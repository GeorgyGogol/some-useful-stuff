# Организация проектов MSVS

По-умолчанию, студия создает 2 файла проекта и 1 дополнительный, содержащий
информацию о последнем билде (как правило):
* .vcxproj - Настройки проекта (жуткий страшный файл)
* .vcxproj.filters - Фильтры и файлы, отображаемые в обозревателе в студии
* .vcxproj.user - тот самый ненужный файл

Все файлы являются XML-документами. Их можно разделить на что-то удобоваримое,
понятное и переносимое (я про "от студии к студии")

# Общий смысл некоторых вещей

Некоторые названия будут являться общими для разных вариантов

* Resources - файлы ресурсов
* include - заголовки для импорта проекта

# Версия с форума

На [форуме][forumLink0] предлагается следующее физическое разделение проекта:

```
project
|---msvs
|---build
|---external
|---include
|---source
```

* MSVS - файлы организации проекта
* build - файлы билда
* external - внешние зависимости
* source - исходный код

Имеет право на жизнь, но как по мне - не очень. Больше понравилась моя вариация

# Моя вариация

Выстрадал, пока увлекался студийными проектами. Долго и у_порно шел к этому, почему не
дошел - ниже

```
SolutionDir
|---Solutioin.sln
|---ProjectsProps
|   |---BuildDirs.vcxproj
|
|---ProjectsVS
|   |---MainProjectName.vcxproj
|   |---SubProject1.vcxproj
|   |---SubProjectN.vcxproj
|
|---Resources
|---.BuildDir
|---Tests
|---include
|---modules
|---Doc
|---Sources || MainProjectName
|---SubProject1
|---SubProjectN
```

* ProjectsProps - файлы свойств проектов .props с описанием включаемых файлов
* ProjectsVS - файлы проектов студии
* .BuildDir - рабочая директория для сборки
* Tests - тесты проекта
* modules - актуально для git: подмодули репозитория
* Doc - файлы, связанные с документацией
* Sources или скорее MainProjectName - директория с исходниками основного проекта
* SubProject< N > - директории подпроектов (на самом деле тесты - тоже продпроект)

Фишка в том, что фактически информация о файлах проекта(ов) хранится в ProjectsProps, а о
сборке в самих .vcxproj, а не все в одном месте. По идее это должно дать возможность
маневрирования между разными студиями, но есть нюанс: для сборки нужно соблюдать
строгий buildDir для разных проектов. Да, это решаетсся страницей свойств для директорий
сборки. Но это черевато тем, что основной и импортируемый проекты будут настроены на
разные выходные директории (BuildDir и build, например) с разной структурой.

В целом, сойдет для каких-то локальных, независимых проектов. Так же хорошо для старта

# За и против

| Плюсы                                  | Минусы                                  |
| -------------------------------------- | --------------------------------------- |
| Студия сама обо всем заботится         | Кроме совместимости?                    |
| Микроконтроль файлов исходников        |                                         |
| Микроконтроль проектов                 | Непонятки с build для разных проектов   |
| Для простого проекта можно не думать   |                                         |
| Свои зависимости подтягиваются студией | Чужие зависимости - геморрой            |
| MS CppUnitTestFramework                |                                         |
| Никаких скриптов, только XML           | Нужно знать XML схему для проектов      |
| Доступ к Windows по дефолту            |                                         |
| Куча настроек проекта                  |                                         |
|                                        | Билд возможен только студией            |
| Понятные макросы                       |                                         |
|                                        | Приколдесы могут быть не доступны       |
| Понятные зависимости проекта           | Прописывание IncludePath и ExternalPath |

# XML схема проектов

Для файлов страниц свойств. Файлы проектов контролируются студией, так что зачем ей
мешать этим заниматься?

## Общее и директории

PropertyGroup - задание группы свойств
OutDir - выходная директория билда
IntDir - директория, где будут жить временные файлы билда
TargetName - название конченного файла
IncludePath - директории включения, в которых будет происходить поиск
ExternalPath - внешние директории включения

## Файлы

ClInclude - заголовочный файл
ClCompile - компилируемый файл (исходник)

Синтаксис не совсем тривиальный:

```XML
<ClInclude Include="Header.h" />
```

# Соус

* Про файлы прокта студии: https://habr.com/ru/articles/448216/

[forumLink0]: https://www.cyberforum.ru/cpp-ide-tools/thread1796305.html

